meta {
  name: create
  type: http
  seq: 2
}

post {
  url: {{baseUrl}}/api/products
  body: json
  auth: inherit
}

body:json {
  {
    "nome": "Pôster Geométrico",
    "descricao": "Arte minimalista inspirada na Bauhaus",
    "preco": 199.9,
    "cover": "/covers/geom.jpg"
  }
}

tests {
  expect res.status toBe 201
  expect body.id toBeDefined
}

script:post-response {
  if (res.body?.id) {
    bru.setVar("productId", res.body.id);
  }
}